# 系统界面导入操作指南

## 📋 导入前准备

### 1. 确认基础数据已就绪

在导入转换后的数据前，确保系统中已有：

- ✅ 至少一个基地
- ✅ 必要的仓库/直播间（对应到货/出库记录中的仓库名称）
- ✅ 必要的人员（对应出库记录中的主播名称）
- ✅ 管理员账号权限

### 2. 准备转换后的 Excel 文件

确保已运行转换脚本，并复查修正了数据：

```bash
cd scripts/data-migration
npm run convert:excel
```

文件位置：`output/converted/`

## 🔄 导入顺序和步骤

### 第一步：导入品类数据

**文件**：`01_商品数据.xlsx` - "品类数据"工作表

**操作步骤**：
1. 登录系统
2. 进入"基础数据" → "商品品类"
3. 逐个手动创建品类：
   - 品类代码：如 `CARD`
   - 品类名称：如 `卡牌`
   - 描述：可选

**品类列表**（参考）：
- CARD - 卡牌
- CARD_BRICK - 卡砖
- STAMP - 邮票
- TEAR_CARD - 撕撕乐
- COLOR_PAPER - 色纸
- TOY - 玩具
- GIFT - 礼物
- FORTUNE_SIGN - 上上签
- LUCKY_CAT - 招财猫

### 第二步：导入商品数据

**文件**：`01_商品数据.xlsx` - "商品数据"工作表

#### 方案 A：使用系统导入功能（如果有）

1. 进入"基地管理" → "商品管理"
2. 点击"导入"或"批量导入"按钮
3. 选择 Excel 文件
4. 映射字段：
   - 商品编号 → code
   - 中文名称 → name
   - 厂商 → manufacturer
   - 品类 → category
   - 盒/箱 → packPerBox
   - 包/盒 → piecePerPack
5. 预览数据
6. 确认导入

#### 方案 B：手动逐条录入

如果系统暂时没有批量导入功能：

1. 进入"基地管理" → "商品管理"
2. 点击"新增商品"
3. 填写表单：
   - **商品编号**：从 Excel 复制（如 `10001`）
   - **商品名称**：从 Excel 复制
   - **厂商**：从 Excel 复制
   - **品类**：选择对应的品类
   - **盒/箱**：填写数量
   - **包/盒**：填写数量
   - **零售价**：需要手动填写（Excel 中没有）
4. 保存
5. 重复以上步骤

**提示**：
- 可以使用 Excel 的筛选功能，按品类分组导入
- 建议先导入常用商品，不常用的可以后续补充
- 商品编号必须唯一，不能重复

### 第三步：创建人员和仓库映射

在导入库存记录前，需要确保系统中的人员和仓库与 Excel 中的名称对应。

#### 3.1 创建人员

1. 进入"基地管理" → "人员管理"
2. 为每个主播/运营创建人员记录：
   - **人员编号**：自动生成
   - **姓名**：与 Excel 中的主播名称一致
   - **类型**：主播/运营
   - **所属基地**：选择对应基地

**Excel 中的人员名称示例**：
- Thùy 阿锤
- Thành Đạt 成达
- Bùi Anh 倍英
- Uyên Mai 媛梅

#### 3.2 创建仓库/直播间

1. 进入"基地管理" → "仓库管理"
2. 为每个仓库/直播间创建记录：
   - **编号**：自动生成
   - **名称**：与 Excel 中的仓库名称一致
   - **类型**：仓库/直播间
   - **所属基地**：选择对应基地

**Excel 中的仓库名称示例**：
- G层仓库
- 总仓库
- 主播直播间（如果有）

### 第四步：导入到货记录

**文件**：`02_到货记录.xlsx`

**前置条件**：
- ✅ 商品已导入
- ✅ 仓库已创建

**操作步骤**：

#### 如果系统有采购/到货功能：

1. 进入"库存管理" → "到货管理"
2. 创建到货单：
   - **到货日期**：从 Excel 复制
   - **仓库**：选择对应仓库
3. 添加商品明细：
   - **商品**：选择对应商品
   - **箱数**：从 Excel 复制
   - **盒/箱**：从 Excel 复制
   - **包/盒**：从 Excel 复制
4. 保存并确认

#### 如果系统没有到货功能：

可以暂时跳过历史到货记录，直接在库存中调整期初库存。

### 第五步：导入出库记录

**文件**：`03_出库记录.xlsx`

**前置条件**：
- ✅ 商品已导入
- ✅ 仓库已创建
- ✅ 人员已创建
- ✅ 有库存可出

**操作步骤**：

1. 进入"库存管理" → "出库管理"
2. 创建出库单：
   - **出库日期**：从 Excel 复制
   - **出库类型**：主播取货
   - **目标主播**：选择对应主播
3. 添加商品明细：
   - **商品**：选择对应商品
   - **数量**：从 Excel 复制
4. 保存并确认

### 第六步：导入调货记录

**文件**：`04_调货记录.xlsx`

**前置条件**：
- ✅ 商品已导入
- ✅ 源仓库和目标仓库已创建
- ✅ 源仓库有库存可调

**操作步骤**：

1. 进入"库存管理" → "调货管理"
2. 创建调货单：
   - **调货日期**：从 Excel 复制
   - **源仓库**：选择对应仓库
   - **目标仓库**：选择对应仓库
3. 添加商品明细：
   - **商品**：选择对应商品
   - **数量**：从 Excel 复制
4. 保存并确认

## 📊 导入进度追踪

建议使用 Excel 追踪导入进度：

| 数据类型 | 总数 | 已导入 | 失败 | 备注 |
|---------|------|--------|------|------|
| 品类 | 9 | 0 | 0 | |
| 商品 | 114 | 0 | 0 | |
| 到货记录 | 123 | 0 | 0 | |
| 出库记录 | 936 | 0 | 0 | |
| 调货记录 | 512 | 0 | 0 | |

## ⚠️ 注意事项

### 数据一致性

- **商品编号**：必须与 Excel 中完全一致
- **人员姓名**：必须与 Excel 中完全一致
- **仓库名称**：必须与 Excel 中完全一致
- **日期格式**：确保日期格式正确

### 库存逻辑

- 到货会增加库存
- 出库会减少库存
- 调货会从源仓库减少，目标仓库增加
- 确保操作顺序正确，避免负库存

### 错误处理

如果导入失败：
1. 检查错误信息
2. 修正 Excel 数据
3. 重新导入失败的记录
4. 记录问题和解决方案

## 💡 优化建议

### 分批导入

不要一次性导入所有数据，建议：

1. **第一批**：导入 10-20 个常用商品，测试流程
2. **第二批**：导入剩余商品
3. **第三批**：导入近期（如最近一个月）的库存记录
4. **第四批**：根据需要导入历史记录

### 简化策略

如果历史数据太多，可以考虑：

- 只导入商品数据
- 只导入最近 1-3 个月的库存记录
- 历史数据作为参考，不导入系统
- 在系统中设置期初库存，从新开始记录

### 数据验证

每批导入后，验证：
- ✅ 商品数量是否正确
- ✅ 库存数量是否合理
- ✅ 人员和仓库是否匹配
- ✅ 日期是否正确

## 🔍 常见问题

### Q1: 系统没有批量导入功能怎么办？

可以：
1. 手动逐条录入（推荐先导入常用数据）
2. 联系开发人员添加批量导入功能
3. 使用 API 脚本批量导入（需要技术支持）

### Q2: 人员/仓库名称不匹配怎么办？

在 Excel 中使用查找替换功能，统一名称：
- 找到所有变体（如 "Thùy 阿锤" 和 "阿锤"）
- 统一为系统中的标准名称

### Q3: 库存数量对不上怎么办？

1. 检查导入顺序是否正确
2. 检查是否有重复导入
3. 使用系统的库存盘点功能调整
4. 如果差异较大，考虑重新设置期初库存

### Q4: 日期格式错误怎么办？

在 Excel 中统一日期格式：
1. 选中日期列
2. 设置单元格格式为"日期"
3. 选择格式：`YYYY-MM-DD`

## 📝 导入完成后

1. ✅ 验证数据完整性
2. ✅ 检查库存数量
3. ✅ 测试系统功能
4. ✅ 培训录入人员
5. ✅ 备份数据库

## 🆘 需要技术支持？

如果需要批量导入功能或遇到技术问题，请联系我，我可以：
- 创建 API 批量导入脚本
- 添加系统批量导入功能
- 协助解决数据导入问题
