# 快速开始 - 数据转换工具

## 🎯 目标

将旧系统的 CSV 数据转换为 Excel 格式，方便人工复查后通过系统界面手动导入。

**注意**：这个工具**只做数据转换**，不会自动导入数据库。

## 📋 转换流程

```
旧CSV数据 → 转换脚本 → Excel文件 → 人工复查 → 系统界面导入
```

## 🚀 使用步骤

### 1. 安装依赖

```bash
cd scripts/data-migration
npm install
```

### 2. 运行转换

```bash
npm run convert:excel
```

### 3. 查看输出文件

转换后的 Excel 文件保存在 `output/converted/` 目录：

- **01_商品数据.xlsx** - 包含商品和品类数据
- **02_到货记录.xlsx** - 入库记录
- **03_出库记录.xlsx** - 出库记录
- **04_调货记录.xlsx** - 调货记录

### 4. 人工复查

打开 Excel 文件，检查并修正：
- ✅ 商品编号是否正确
- ✅ 商品名称是否完整
- ✅ 品类分类是否合理
- ✅ 数量单位是否正确
- ✅ 日期格式是否正确
- ✅ 人员/仓库名称是否匹配系统中的数据

### 5. 通过系统导入

复查完成后，通过系统界面手动导入：

#### 5.1 导入商品数据
1. 登录系统
2. 进入"基地管理" → "商品管理"
3. 点击"导入"按钮
4. 上传 `01_商品数据.xlsx`
5. 确认导入

#### 5.2 导入库存记录
1. 进入"库存管理" → 对应的功能页面
2. 使用系统的导入功能
3. 上传对应的 Excel 文件

## 📊 输出文件说明

### 01_商品数据.xlsx

包含两个工作表：

**商品数据表**：
- 商品编号（必填）
- 中文名称（必填）
- 越南语名称
- 厂商（必填）
- 品类代码
- 品类名称
- 盒/箱
- 包/盒
- 状态
- 备注

**品类数据表**：
- 品类代码
- 品类名称

### 02_到货记录.xlsx

- 商品编号
- 商品名称
- 仓库名称
- 到货日期
- 箱数
- 盒/箱
- 包/盒
- 总包数
- 备注

### 03_出库记录.xlsx

- 商品编号
- 商品名称
- 主播名称
- 出库日期
- 箱数
- 包数
- 零散包数
- 出库类型
- 目标
- 备注

### 04_调货记录.xlsx

- 商品编号
- 商品名称
- 源仓库
- 目标仓库
- 调货日期
- 箱数
- 包数
- 零散包数
- 备注

## ⚠️ 注意事项

### 数据清洗规则

转换脚本会自动处理：
- ✅ 日期格式统一为 `YYYY-MM-DD`
- ✅ 去除多余的空白字符
- ✅ 跳过空行
- ✅ 品类自动映射

### 需要人工处理

以下情况需要人工复查和修正：
- ⚠️ 商品编号重复
- ⚠️ 人员名称不匹配（需要对应到系统中的人员）
- ⚠️ 仓库名称不匹配（需要对应到系统中的仓库）
- ⚠️ 日期格式异常
- ⚠️ 数量为负数或异常值

### 导入顺序

**必须按以下顺序导入**：

1. **商品数据**（先导入品类，再导入商品）
2. **到货记录**（需要先有商品和仓库）
3. **出库记录**（需要先有商品、仓库和人员）
4. **调货记录**（需要先有商品和仓库）

## 🔧 常见问题

### Q1: 转换失败怎么办？

检查 CSV 文件：
- 文件编码是否为 UTF-8
- 文件是否损坏
- 列名是否正确

### Q2: Excel 中有错误记录怎么办？

每个 Excel 文件如果有转换错误，会包含一个"错误记录"工作表，列出所有错误的行和原因。

### Q3: 如何修改品类映射？

编辑 `src/config.js` 中的 `categoryMapping` 配置：

```javascript
categoryMapping: {
  'Card/卡牌': 'CARD',
  'Thẻ hộp/卡砖': 'CARD_BRICK',
  // 添加更多映射...
}
```

### Q4: 系统没有导入功能怎么办？

如果系统界面暂时没有批量导入功能，可以：
1. 使用 Excel 作为参考
2. 在系统中逐条手动录入
3. 或者联系我，我可以帮你创建 API 批量导入脚本

## 📝 下一步

转换完成后：
1. ✅ 打开 Excel 文件复查数据
2. ✅ 修正任何错误
3. ✅ 准备好系统中的基础数据（人员、仓库）
4. ✅ 按顺序通过系统界面导入

## 💡 提示

- 建议先导入少量数据测试，确认无误后再批量导入
- 保留原始 CSV 文件作为备份
- 每次导入前备份数据库
- 导入过程中如有问题，及时记录并反馈

## 🆘 需要帮助？

如果遇到问题，请提供：
1. 错误信息或截图
2. 具体的 CSV 文件内容（脱敏后）
3. 转换后的 Excel 文件

我会帮你解决！
