# Milicard Server

Milicard ç³»ç»Ÿçš„åç«¯ API æœåŠ¡å™¨ï¼ŒåŸºäº Express + TypeScript + Prisma æ„å»ºã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–
```bash
npm install
```

### 2. ç¯å¢ƒé…ç½®
å¤åˆ¶ç¯å¢ƒå˜é‡æ–‡ä»¶å¹¶é…ç½®æ•°æ®åº“è¿æ¥ï¼š
```bash
cp .env.example .env
```

ç¼–è¾‘ `.env` æ–‡ä»¶ï¼Œé…ç½®ä½ çš„ PostgreSQL æ•°æ®åº“è¿æ¥ï¼š
```env
DATABASE_URL="postgresql://username:password@localhost:5432/milicard_dev?schema=public"
```

### 3. æ•°æ®åº“è®¾ç½®
```bash
# ç”Ÿæˆ Prisma å®¢æˆ·ç«¯
npm run db:generate

# æ¨é€æ•°æ®åº“ç»“æ„ï¼ˆå¼€å‘ç¯å¢ƒï¼‰
npm run db:push

# æˆ–è€…ä½¿ç”¨è¿ç§»ï¼ˆç”Ÿäº§ç¯å¢ƒæ¨èï¼‰
npm run db:migrate

# åˆå§‹åŒ–ç§å­æ•°æ®
npm run db:seed
```

### 4. å¯åŠ¨æœåŠ¡å™¨
```bash
# å¼€å‘æ¨¡å¼
npm run dev

# ç”Ÿäº§æ¨¡å¼
npm run build
npm start
```

## ğŸ“‹ å¯ç”¨è„šæœ¬

- `npm run dev` - å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼ˆçƒ­é‡è½½ï¼‰
- `npm run build` - æ„å»ºç”Ÿäº§ç‰ˆæœ¬
- `npm start` - å¯åŠ¨ç”Ÿäº§æœåŠ¡å™¨
- `npm test` - è¿è¡Œæµ‹è¯•
- `npm run db:generate` - ç”Ÿæˆ Prisma å®¢æˆ·ç«¯
- `npm run db:push` - æ¨é€æ•°æ®åº“ç»“æ„åˆ°æ•°æ®åº“
- `npm run db:migrate` - åˆ›å»ºå’Œåº”ç”¨æ•°æ®åº“è¿ç§»
- `npm run db:studio` - å¯åŠ¨ Prisma Studio æ•°æ®åº“ç®¡ç†ç•Œé¢
- `npm run db:seed` - è¿è¡Œç§å­æ•°æ®è„šæœ¬

## ğŸ—„ï¸ æ•°æ®åº“

ç³»ç»Ÿä½¿ç”¨ PostgreSQL æ•°æ®åº“ï¼Œé€šè¿‡ Prisma ORM è¿›è¡Œç®¡ç†ã€‚

### é»˜è®¤è´¦å·
ç§å­æ•°æ®ä¼šåˆ›å»ºä¸€ä¸ªé»˜è®¤ç®¡ç†å‘˜è´¦å·ï¼š
- ç”¨æˆ·åï¼š`admin`
- å¯†ç ï¼š`admin123`

### æ•°æ®åº“ç»“æ„
è¯¦ç»†çš„æ•°æ®åº“è®¾è®¡è¯·å‚è€ƒï¼š`../doc/database/schema_design.md`

## ğŸ”§ å¼€å‘

### é¡¹ç›®ç»“æ„
```
src/
â”œâ”€â”€ controllers/     # æ§åˆ¶å™¨
â”œâ”€â”€ middleware/      # ä¸­é—´ä»¶
â”œâ”€â”€ routes/         # è·¯ç”±å®šä¹‰
â”œâ”€â”€ services/       # ä¸šåŠ¡é€»è¾‘æœåŠ¡
â”œâ”€â”€ utils/          # å·¥å…·å‡½æ•°
â”œâ”€â”€ types/          # TypeScript ç±»å‹å®šä¹‰
â””â”€â”€ index.ts        # åº”ç”¨å…¥å£
```

### API æ–‡æ¡£
API æ–‡æ¡£å°†åœ¨å¼€å‘è¿‡ç¨‹ä¸­é€æ­¥å®Œå–„ï¼Œè®¡åˆ’ä½¿ç”¨ Swagger ç”Ÿæˆã€‚

## ğŸ”’ å®‰å…¨

- JWT è®¤è¯
- Casbin æƒé™ç®¡ç†
- è¯·æ±‚é€Ÿç‡é™åˆ¶
- CORS é…ç½®
- å®‰å…¨å¤´éƒ¨ï¼ˆHelmetï¼‰

## ğŸ“ æ—¥å¿—

ç³»ç»Ÿä½¿ç”¨ Winston è¿›è¡Œæ—¥å¿—è®°å½•ï¼š
- å¼€å‘ç¯å¢ƒï¼šæ§åˆ¶å° + æ–‡ä»¶
- ç”Ÿäº§ç¯å¢ƒï¼šæ–‡ä»¶è®°å½•
- æ—¥å¿—æ–‡ä»¶ä½ç½®ï¼š`logs/`

## ğŸš€ éƒ¨ç½²

è¯¦ç»†çš„éƒ¨ç½²è¯´æ˜è¯·å‚è€ƒï¼š`../doc/deployment/`

## ğŸ“ æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹æ–‡æ¡£æˆ–è”ç³»å¼€å‘å›¢é˜Ÿã€‚
