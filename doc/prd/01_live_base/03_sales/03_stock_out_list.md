# 模块：出库管理

- **参考截图**: `15_出库.png`
- **URL**: `/live-base/sales/stock-out`

---

## 1. 功能概述

此页面用于记录和管理分销订单的出库流水。它是“分销管理”流程的执行环节，追踪商品从仓库到客户的实际流动。

**核心业务逻辑**: 出库记录必须关联一个已存在的分销单，支持一个分销单分批次出库。创建出库记录后，系统会自动扣减“仓库”模块中对应商品的库存。

---

## 2. 页面布局与功能

### 2.1 搜索与操作

- **搜索**: 
  - 页面顶部提供多个筛选条件，如“销售单”、“客户”、“商品”、“仓库”、“主播”和“日期范围”等。
  - 点击“搜索” (Search) 按钮后，下方列表根据条件进行过滤。
- **主要操作**:
  - **添加 (Add)**: 点击跳转到“添加出库记录”页面。
  - **导入 (Import)**: 批量导入出库记录。
  - **导出 (Export)**: 导出出库记录列表。

### 2.2 出库列表

- **数据展示**: 页面主体为一个表格，展示出库记录的详细信息。
- **分页**: 表格下方应有分页组件。
- **表格列**:
  - **ID**: 唯一标识符。
  - **日期**: 出库操作的日期。
  - **销售**: 关联的分销订单名称或编号。
  - **客户**: 接收货物的分销客户。
  - **商品**: 本次出库的商品。
  - **仓库**: 货物发出的仓库。
  - **主播**: 处理本次出库的主播/经手人。
  - **待出库箱/盒/包**: 在本次出库操作**之前**，该订单的待出库数量。
  - **出库箱/盒/包**: 本次实际出库的数量。
  - **操作**:
    - **删除 (Del)**: 点击后，应弹出确认对话框，确认后删除该出库记录。

---

## 3. 数据模型

```typescript
// file: src/models/stockOut.ts

export interface StockOutRecord {
  id: number;
  date: string;
  distributionOrderId: number; // 关联分销订单
  customerId: number;
  goodsId: number;
  warehouseId: number;
  handlerId: number; // 经手的主播/仓管

  // 本次出库前的待出库数量
  pendingBeforeBox: number;
  pendingBeforeUnit: number;
  pendingBeforeSubUnit: number;

  // 本次出库数量
  stockOutBox: number;
  stockOutUnit: number;
  stockOutSubUnit: number;
}
```

---

## 4. 已确认的业务规则

1.  **数据关联**: 添加出库记录时 **必须** 关联一个已存在的分销订单。
2.  **待出库数量**: “待出库”字段是在本次出库操作发生**之前**，从关联分销订单中读取的快照数据，用于展示历史状态。
3.  **编辑功能**: 出库记录一旦创建不允许修改。如需更正，应删除后重新创建。
